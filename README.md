Here is a practice on how to refactor to a visitor pattern.
Code base: https://github.com/qinghua/VisitorPattern.git
Evernote: https://www.evernote.com/shard/s239/sh/4dbf0ddb-892b-4ebc-a9cd-8431b19b7a02/23d2b6797261d36329d3b24848b76a14

Feel free to tell me if you have any concerns.
